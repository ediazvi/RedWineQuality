---
title: 'Tipologia y ciclo de vida de los datos - PRA2'
author: "Autor: Eduardo Diaz Villanueva"
date: "Enero 2021"
output:
  pdf_document:
    highlight: zenburn
    toc: yes
  word_document: default
  html_document:
    highlight: default
    number_sections: yes
    theme: cosmo
    toc: yes
    toc_depth: 2
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Lectura de datos

```{r }
library(stringr)
library(dplyr)
library(ggplot2)

# Limpiamos la aplicacion de datos anteriores y cargo el fichero.
rm(list = ls())
datos <- read.csv("winequality-red.csv", sep=",")
datos_originales <- datos
head(datos,5)
```

# Descripción del dataset.
El dataset seleccionado contiene 11 variables que describen las propiedades quimicas de un vino, como puede ser la acided, ph nivel de azucar, etc... estas variables tendran influencia en la calidad final del vino.

Con este ejercicio queremos estudiar que variables son mas representativas y encontrar modelos que puedan predecir la calidad del vino.

Si pensamos por ejemplo en una industria, podriamos reducir el tiempo y coste reduciendo el numero de pruebas de calidad a las variables mas significativas. Incluso mejorar la calidad del producto final, focalizando esfuerzos y recursos a reducir la variabiliad de las varibles que mas contribuyan a la calidad final.

# Integracion y seleccion de los datos de interes

Realizaremos un primer analisis estadistico para familiarizarnos con las variables.
````{r }
summary(datos)
str(datos)

#Tipo de dato asignado a cada campo
sapply(datos, function(x) class(x))
```

````{r }

```

# Limpieza de los datos

## Elementos vacios

Analizamos los valores para detectar falta o ausencia de daos
````{r }
# Analizamos la existencia de datos NA
colSums(is.na(datos))
```

````{r }
# Analizamos la existencia de datos vacios
colSums(datos=="")
```

````{r }
# Analizamos la existencia de datos con valor 0
colSums(datos==0)

```

Observamos la variable Citric.acid con una gran cantidad de valores 0. 

## Valores extremos 

````{r }
boxplot(x=datos[,1:11],main="Boxplots datos")

#boxplot(x=datos[,1:5],main="Boxplots datos")
#boxplot(x=datos[,6:7],main="Boxplots datos")
#boxplot(x=datos[,8:12],main="Boxplots datos")


par(mfrow=c(1,2))
hist(datos$fixed.acidity)
boxplot(datos$fixed.acidity,main="fixed.acidity", col="gray")
boxplot.stats(datos$fixed.acidity)$out

par(mfrow=c(1,2))
hist(datos$volatile.acidity)
boxplot(datos$volatile.acidity,main="volatile.acidity", col="gray")
boxplot.stats(datos$volatile.acidity)$out

par(mfrow=c(1,2))
hist(datos$citric.acid )
boxplot(datos$citric.acid ,main="citric.acid ", col="gray")
boxplot.stats(datos$citric.acid )$out

par(mfrow=c(1,2))
hist(datos$residual.sugar)
boxplot(datos$residual.sugar,main="residual.sugar", col="gray")
boxplot.stats(datos$residual.sugar)$out

par(mfrow=c(1,2))
hist(datos$chlorides)
boxplot(datos$chlorides,main="chlorides", col="gray")
boxplot.stats(datos$chlorides)$out

par(mfrow=c(1,2))
hist(datos$free.sulfur.dioxide)
boxplot(datos$free.sulfur.dioxide,main="free.sulfur.dioxide", col="gray")
boxplot.stats(datos$free.sulfur.dioxide)$out

par(mfrow=c(1,2))
hist(datos$total.sulfur.dioxide)
boxplot(datos$total.sulfur.dioxide,main="total.sulfur.dioxide", col="gray")
boxplot.stats(datos$total.sulfur.dioxide)$out

par(mfrow=c(1,2))
hist(datos$density)
boxplot(datos$density,main="density", col="gray")
boxplot.stats(datos$density)$out

par(mfrow=c(1,2))
hist(datos$pH)
boxplot(datos$pH,main="pH", col="gray")
boxplot.stats(datos$pH)$out


par(mfrow=c(1,2))
hist(datos$sulphates)
boxplot(datos$sulphates,main="sulphates", col="gray")
boxplot.stats(datos$sulphates)$out

par(mfrow=c(1,2))
hist(datos$alcohol)
boxplot(datos$alcohol,main="alcohol", col="gray")
boxplot.stats(datos$alcohol)$out

par(mfrow=c(1,2))
hist(datos$quality)
boxplot(datos$quality,main="quality", col="gray")
boxplot.stats(datos$quality)$out


```



# Analisis

Antes de comenzar con el analisis guardaremos una copia de los datos despues del proceso de limpieza
````{r }
# Exportación de los datos limpios en .csv
write.csv(datos, "datos_data_clean.csv")

```

Analizaremos las variables frente a la calidad para decidir cuaes utilizar en el resto del analisis

````{r }
#boxplot(datos$pH,main="quality", col="gray")
boxplot(formula = datos$fixed.acidity ~ datos$quality, main="fixed.acidity vs quality", col="gray")

boxplot(formula = datos$volatile.acidity ~ datos$quality, main="volatile.acidity vs quality", col="gray")

boxplot(formula = datos$citric.acid ~ datos$quality, main="citric.acid vs quality", col="gray")

boxplot(formula = datos$residual.sugar ~ datos$quality, main="residual.sugar vs quality", col="gray")

boxplot(formula = datos$chlorides ~ datos$quality, main="chlorides vs quality", col="gray")

boxplot(formula = datos$free.sulfur.dioxide ~ datos$quality, main="free.sulfur.dioxide vs quality", col="gray")

boxplot(formula = datos$total.sulfur.dioxide ~ datos$quality, main="total.sulfur.dioxide vs quality", col="gray")

boxplot(formula = datos$density ~ datos$quality, main="density vs quality", col="gray")

boxplot(formula = datos$pH ~ datos$quality, main="pH vs quality", col="gray")

boxplot(formula = datos$sulphates ~ datos$quality, main="sulphates vs quality", col="gray")

boxplot(formula = datos$alcohol ~ datos$quality, main="alcohol vs quality", col="gray")

```




## Seleccion grupo de datos

````{r }

```


## Comprobación de la normalidad y homogeneidad de la varianza.


```{r ,eval=TRUE,echo=TRUE}
shapiro.test(datos$fixed.acidity)
```


El test nos indica que ninguna variable esta normalizada, ya que el p-valor es inferior al coeficiente 0.05, por lo que se puede rechazar la hipotesis nula y entender que no es normal.

Que no sea normal no quiere decir que no pueda ser normalizable, ya que segun el teorema del limite central al tener mas de 30 elementos en las observaciones podemos aproximarla como una distribución normal de media 0 y desviación estandard 1.




````{r }

```

## Aplicación de pruebas estadísticas para comparar los grupos de datos

````{r }

```


# Representación de los resultados

````{r }

```

# Resolución del problema

````{r }

```
